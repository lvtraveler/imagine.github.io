<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.5.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="Imagine" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.5.0" />






<meta name="description" content="this is imagine life">
<meta property="og:type" content="website">
<meta property="og:title" content="Imagine">
<meta property="og:url" content="http://lvtraveler.github.io/index.html">
<meta property="og:site_name" content="Imagine">
<meta property="og:description" content="this is imagine life">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Imagine">
<meta name="twitter:description" content="this is imagine life">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>

  <title> Imagine </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  



  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "//hm.baidu.com/hm.js?e1728a0d233cdc31b7d6a7ba7d1be78f";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>








  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Imagine</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-heartbeat fa-fw"></i> <br />
            
            公益404
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="#" class="st-search-show-outputs">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <form class="site-search-form">
  <input type="text" id="st-search-input" class="st-search-input st-default-search-input" />
</form>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
    (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
    e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install', 'ukfWgk3L9zSEhKjpzZip','2.0.0');
</script>



    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/07/js闭包之块级作用域/" itemprop="url">
                  《js闭包之块级作用域》
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-07T09:19:19+08:00" content="2016-05-07">
              2016-05-07
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/07/js闭包之块级作用域/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/07/js闭包之块级作用域/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在js中我们应该尽量避免使用全局变量和全局函数，以防止发生命名冲突，那么要如何避免呢？js中有一个闭包的概念，现在我们使用闭包中块级作用域来讲解，这也是闭包中最重要的概念。</p>
<p>js本身是不支持像C/C#/java…这样的语言中有块级作用域的，<strong>即在语法块中定义的变量，在语法块外面是无法访问到的。</strong></p>
<p>那么，js要怎么去模拟像C这样的块级作用域呢？我们先来看一个栗子：</p>
<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> test();</span><br><span class="line"> function test() &#123;</span><br><span class="line">	(function()&#123;</span><br><span class="line">		for(var i=0;i&lt;3;i++)&#123;</span><br><span class="line">			console.log(i);//这个时候i就在**匿名函数里**面有效了，在**匿名函数外**无效，在匿名函数外，i就被销毁了</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)();	</span><br><span class="line">	console.log(i);//输出:undefined</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在函数内部创建一个匿名函数，就相当于在函数内部创建了一个私有作用域，这对于在较大/多人开发的项目中是很好用的，这样每个程序员能在自己的功能函数中使用自己的变量不至于混乱、冲突。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/05/05/angular-大漠秋穷01/" itemprop="url">
                  《AngularJS实例-01》
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-05-05T22:10:46+08:00" content="2016-05-05">
              2016-05-05
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/05/05/angular-大漠秋穷01/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/05/05/angular-大漠秋穷01/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="初探四大特性"><a href="#初探四大特性" class="headerlink" title="初探四大特性"></a>初探四大特性</h2><h3 id="angular四大核心特性："><a href="#angular四大核心特性：" class="headerlink" title="angular四大核心特性："></a>angular四大核心特性：</h3><ul>
<li><p>MVC</p>
</li>
<li><p>模块化</p>
</li>
<li><p>指令系统（ng特有）</p>
</li>
<li><p>双向数据绑定(ng特有)</p>
</li>
</ul>
<h3 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h3><p>首先，来了解ng的第一个特性：MVC</p>
<p>Model:数据模型层；</p>
<p>View :视图层，负责展示，我们眼睛能看到的那些东西都属于视图；</p>
<p>Controller:业务逻辑和控制逻辑放的地方；</p>
<p>MVC的好处：</p>
<p>职责清晰，代码模块化，便于复用，例如像Model、View这种东西，能够经常的复用，因为很多地方的界面展示是一模一样的；</p>
<p>MVC属于架构模式，它是观察者模式、策略模式、组合模式的组合；</p>
<p>在ng的语境下，你要很熟悉代码中哪些是Model，哪些是View，哪些是Controller；</p>
<p>例如：有这么一段代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;title&gt;&lt;/title&gt;</span><br><span class="line">	&lt;script type=&quot;text/javascript&quot; src=&quot;http://cdn.staticfile.org/angular.js/1.3.0-beta.13/angular.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!--Controller: 给div放置一个控制器testController --&gt;</span><br><span class="line">	&lt;div ng-controller=&quot;testController&quot;&gt;</span><br><span class="line">		&lt;!-- Model、View:数据模型&#123;&#123;&#125;&#125;、View:&lt;p&gt;标签 --&gt;</span><br><span class="line">		&lt;p&gt;&#123;&#123;greeting.text&#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">	&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		function testController($scope) &#123;//控制器,负责业务逻辑与控制逻辑</span><br><span class="line">			$scope.greeting=&#123;</span><br><span class="line">				text:&apos;Hello ng&apos;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h3><p>上面的代码中我们看到，我们定义了一个全局的函数testController,这显然不好。现在我们对这个function进行改进：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app=&quot;test_ng&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;title&gt;&lt;/title&gt;</span><br><span class="line">	&lt;script type=&quot;text/javascript&quot; src=&quot;http://cdn.staticfile.org/angular.js/1.3.0-beta.13/angular.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!--Controller: 给div放置一个控制器testController --&gt;</span><br><span class="line">	&lt;div ng-controller=&quot;testController&quot;&gt;</span><br><span class="line">		&lt;!-- Model、View:数据模型&#123;&#123;&#125;&#125;、View:&lt;p&gt;标签 --&gt;</span><br><span class="line">		&lt;p&gt;&#123;&#123;greeting.text&#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">	&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		var myModule=angular.module(&quot;test_ng&quot;,[]);//定义一个模块</span><br><span class="line">		//用模块生成一个控制器testController</span><br><span class="line">		myModule.controller(&quot;testController&quot;,[&apos;$scope&apos;,</span><br><span class="line">			function testng($scope)&#123;//第一个参数$scope,在告诉ng,请再testng里注入$scope————即，依赖注入</span><br><span class="line">			$scope.greeting=&#123;</span><br><span class="line">				text:&apos;Hello ng&apos;</span><br><span class="line">			&#125;;</span><br><span class="line">		&#125;</span><br><span class="line">		]);</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>下面我们具体看一下ng的模块化Module概念，并且在Module下有很多的概念。</p>
<blockquote>
<p>需要注意的是：angular是从模块开始的，你在做东西的时候，需要首先想到Module,只有在Module下你才能使用ng的一些概念；</p>
</blockquote>
<p>我们来看一张图：</p>
<p><img src="../../img/ng/ng01.png" alt="alt text" title="Title"></p>
<h3 id="指令系统"><a href="#指令系统" class="headerlink" title="指令系统"></a>指令系统</h3><p>指令系统，是angular最吸引人的部分。</p>
<p>首先上代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app=&quot;MyNg&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">	&lt;/head&gt;</span><br><span class="line">	&lt;title&gt;&lt;/title&gt;</span><br><span class="line">	&lt;script type=&quot;text/javascript&quot; src=&quot;http://cdn.staticfile.org/angular.js/1.3.0-beta.13/angular.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;!-- 浏览器不是识别hello标签 --&gt;</span><br><span class="line">	&lt;hello&gt;&lt;/hello&gt;</span><br><span class="line"></span><br><span class="line">	&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">		var myModule=angular.module(&quot;MyNg&quot;,[]);//定义一个模块</span><br><span class="line">		// 为了让浏览器解析hello这个自定义标签，我们需要借助ng的directive特性</span><br><span class="line">		myModule.directive(&quot;hello&quot;,function()&#123;//hello 对应指令名称，即&lt;hello&gt;&lt;/hello&gt;标签名</span><br><span class="line">			return &#123;</span><br><span class="line">				restrict:&apos;E&apos;,</span><br><span class="line">				template:&apos;&lt;div&gt;Hello angular&lt;/div&gt;&apos;,//hello标签被替换为该模板</span><br><span class="line">				replace:true</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&lt;/script&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>这就是angular的指令系统，有了这个指令系统我们能够做很多事情，比如我们将一个具体的指令进行封装，在其他地方我们就能够进行调用。</p>
<p>当然，指令不仅仅是用来使用自定义标签，它还有其他神奇的功能，例如：</p>
<p>ng-app:这是一个ng指令，ng-app=”MyNg”,表示告诉angular去使用MyNg这个模块。ng-app这个指令可以看成是一个angular的启动指令，或是入口，相当于C语言中得Main（）函数。故，在任意一个单页中只能出现一次ng-app。</p>
<h3 id="双向数据绑定"><a href="#双向数据绑定" class="headerlink" title="双向数据绑定"></a>双向数据绑定</h3><blockquote>
<p>在单向数据绑定中，通常是把模板和数据模型都写好，这个数据模型可能来自后端数据，然后将模板与数据模型合并输出到视图进行展示，这样有一个缺点：即一旦模板与数据模型写好之后，View就无法改变了，如果要改变，那么只能重新再来一次。</p>
</blockquote>
<p>在JqueryUi\Backbone\Flex这样的前端框架中都是这么处理的，这样是否优雅呢？</p>
<p>Angular看到了，就不喜欢了，它就弄了一个双向数据绑定，它认为：</p>
<ul>
<li>视图View和数据Model是对应的，当View上面的内容发生变化的时候，Model也发生变化；当Model发生变化，View会自动更新；——这样的思路需要借助一种事件机制；</li>
</ul>
<p>例如：在HTML中，表单常常会发生变化，因为表单是用来搜集用户的输入，故常常容易发生变化。在angular中，如果数据/表单发生变化，就会同步到Model上面；</p>
<p>下面看代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">	&lt;head&gt;</span><br><span class="line">		&lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">		&lt;title&gt;&lt;/title&gt;</span><br><span class="line">		&lt;script type=&quot;text/javascript&quot; src=&quot;http://cdn.staticfile.org/angular.js/1.3.0-beta.13/angular.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">	&lt;form&gt;</span><br><span class="line">		&lt;!-- 在input中绑定一个ng-model --&gt;</span><br><span class="line">		&lt;input type=&quot;text&quot; placeholder=&quot;请输入&quot; ng-model=&quot;greeting.text&quot;&gt;</span><br><span class="line">		&lt;!-- 在p标签中去获取值，双花括弧在angular中表示取值 --&gt;</span><br><span class="line">		&lt;p&gt;&#123;&#123;greeting.text&#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">	</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>在上面这段代码中，你无需写任务angular代码就能实现一个简单的双向数据绑定。</p>
<h3 id="思考"><a href="#思考" class="headerlink" title="思考"></a>思考</h3><ul>
<li>为什么其他的前端框架不实现双向数据绑定？</li>
<li>双向数据绑定有什么缺点？</li>
</ul>
<h2 id="搭建开发、调式、测试工具"><a href="#搭建开发、调式、测试工具" class="headerlink" title="搭建开发、调式、测试工具"></a>搭建开发、调式、测试工具</h2><p>前端开发中需要什么样的开发环境？</p>
<ul>
<li>代码编辑工具：sublime编辑器</li>
<li>断点调式工具：chrome 插件Batarang</li>
<li>版本管理工具: git,在从github上克隆项目前需要先fork(相当于建立一个自己的分支)，然后再Clone.</li>
<li>代码合并和混淆工具:gulp、grunt</li>
<li>依赖管理工具:bower(自动安装依赖组件、组件之间的依赖检测、版本兼容性自动检测)</li>
<li>轻量级Server—http-server(一款简单的http-server,能将电脑上得任意一个目录变成在浏览器上能访问的；它基于NodeJS的HTTP接口，通过npm 安装，主要用来模拟与后端交互的数据)</li>
<li><p>单元测试工具：karma配合jasmine（通过npm安装）。jasmine有四个核心概念：分组、用例、期望、匹配，分别对应jasmine四种函数。</p>
<p>  （1）describe(string,function)分组，一组测试用例；</p>
<p>  （2）it(string,function)表示测试用例</p>
<p>  （3）expect(expression)表示期望expression这个表达式具有某个值或者具有某种行为；</p>
<p>  （4）to<em>*</em>(arg)表示匹配；</p>
</li>
<li><p>集成测试工具：Proctactor-专门为Angular应用而设计；<br>Proctactor基于webDriverJs;<br>利用webDriverJS,能借助于NodeJS直接调用浏览器的接口；<br><a href="https://github.com/angular/protractor" target="_blank" rel="external">https://github.com/angular/protractor</a><br><a href="https://code.google.com/p/selenium/wiki/WebDriverJs" target="_blank" rel="external">https://code.google.com/p/selenium/wiki/WebDriverJs</a><br>angular官方提供angular-phonecat的例子做为测试；</p>
</li>
</ul>
<p>最后我们来看一个完整的项目目录结构实例：</p>
<p><img src="../../img/ng/ng02.png" alt="alt text" title="Title"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/24/楚亡/" itemprop="url">
                  《楚亡·从项羽到韩信》——重新梳理楚汉之争01___项羽为什么失败
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-24T23:22:15+08:00" content="2016-04-24">
              2016-04-24
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/阅读/" itemprop="url" rel="index">
                    <span itemprop="name">阅读</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/24/楚亡/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/24/楚亡/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近看了一本讲历史的文学书，书名《楚亡·从项羽到韩信》，作者李开元。为什么会去看这本书呢？说来也凑巧，在我上高中的时候偶然间在电视上看到《秦时明月》这部国产动漫，我本身对历史记得不太牢，很多历史在读书的时候杂揉在一起，于是就没有太多印象了，但是看这部动漫的时候，诶~感觉还不错，于是就看到现在。哈哈。但我也不是什么秦迷啦~我感觉自己只是对这段历史是想了解的。虽然，这部动漫很多剧情是虚构的。</p>
<blockquote>
<p>OK，既然说要“重新梳理楚汉之争”，那么我们就来聊聊楚汉之争。</p>
</blockquote>
<p>首先，想问问楚汉争霸中都有哪些主要人物？（不得不赞叹，历史是为天下豪杰写的）项羽、刘邦肯定的了，然后你从这本书名还可以找到韩信这个人，还有呢？————————我们从项羽的楚军和刘邦的汉军来找找这些人。我们根据这几个主要人物来讲楚汉之争。</p>
<p>从两位头头开始吧。</p>
<p>项羽。这个人很厉害，西楚霸王，在项羽败亡之前吟唱的《垓(gai)下歌》中，他都这么自夸自己：‘力拔山兮气盖世,时不利兮骓（zhui,’马’）不逝.骓不逝兮可奈何,虞兮虞兮奈若何！’在开头第一句，他就说了’力拔山兮气盖世’，意思是“老子是盖世英雄，力大无穷能开山”，但是项羽的厉害不止是力气大。——————谁能说说项羽还有哪里厉害的地方呢？取了一位美貌天仙的虞姬？还是他在乌江自刎时那句豪言壮语？</p>
<p>————————项羽是位军人，身上满满军人的血气，自幼跟着叔父项梁打战，在对秦战争中从未有过败仗，多次以少胜多，全歼秦军，在大规模野战中更是得心应手，有如神助。例如：在一次单刀中，项羽骑着坐骑乌骓，对方将领看到项羽瞪了自己一眼，立马吓得魂不守舍，回到阵营不敢出战。在几个著名的战役——如“巨鹿之战大破秦军，项羽破斧沉舟以5万楚军大胜40万秦军，从此确立项羽在反秦联盟中得地位；彭城之战大败刘邦，使刘邦从此不敢与项羽正面交锋”，可以看得出项羽在大战的时候是很有自信的。</p>
<p>但是，唯有这一次——垓下之战，让项羽犹如困在牢笼中感到很不舒服，项羽对部下直言：“这是上天要亡我，而非征战之过错啊！”。项羽很是无奈啊~对了，我们前面说到过项羽在临死前说了一句豪言壮语，这句话也能体现出他的勇气。项羽站在乌江边，对着迎面而来的吕马童喊道：“我听说汉王赏金千金，封邑(yi)万户,要我的头，我成全你！”说完挥剑自刎，年仅31岁。其实，在乌江边上，早有船家在等候项羽过江，但是项羽拒绝了，他说道：“既然天要亡我，又何必渡江！遥想当年八千江东子弟随我渡江西进，如今无一人生还，纵使江东父老兄弟怜爱不弃，仍以我为王，我又有何脸面去见他们？纵使江东父老兄弟默默不言语，我项籍岂能问心无愧啊！”。</p>
<blockquote>
<p>哈哈~英雄，往往因为几句气壮山河的话语让世人铭记。。。</p>
</blockquote>
<p>前面我们说了项羽的厉害之处，有人会问，项羽这么屌，最终为什么会败呢？</p>
<p>我们来说说项羽失败的几处不完全原因：</p>
<p>在荥（xing）阳之战中，两军对峙，项羽一心想引诱刘邦出城会战，刘邦可不干，但是这么一直对峙下去也不是办法，就对项羽喊话：“我刘季宁愿斗志，不能斗力。”，接着高声宣读项羽的十大罪状，我列举主要几条：</p>
<ul>
<li>第一条：项羽违背与刘邦定下的约定：“先入关中者作关中王”；</li>
<li>第二条：违背与楚怀王“进入秦国不得暴掠”的约定，项羽进入关中后，烧毁了秦国的宫殿，破坏秦始皇墓地上的建筑，搜刮财宝据为己有；</li>
<li>第三条：暴虐欺诈，在新安坑杀20万秦军将士；</li>
<li>第四条：驱逐义帝楚怀王，并派人秘密杀害义帝于江南；</li>
</ul>
<p>从上面几条来看，我们能看到项羽的性格缺失：不守信、不敬上、大逆无道、功高自傲；</p>
<p>史太公司马迁在项羽败亡的百年之后，曾总结过项羽失败的原因：</p>
<ul>
<li>战略地理错误：背弃关中，定都彭城；</li>
<li>政治伦理错误：驱逐楚怀王，以下克上；</li>
<li>居功自傲：固执己见，不向历史学习；</li>
<li>以武力经营天下；</li>
</ul>
<p>几千年以来，历史学家们都对项羽的失败做出了不同的评价，可是于己所见，综上项羽所做过的事，可以见得项羽在楚汉之争中渐渐失去了人心，在垓下之战后诸侯国纷纷离他而去，项羽最终失去了帮手，孤军奋战。可见“失人心者失天下”、“水能载舟，亦能覆舟”。</p>
<p>当然，从用人这个角度看，也是项羽失败的原因之一：</p>
<p>项羽身边的文武官，大都是由项羽的家族人士来担当，例如项梁、项伯、项庄，亚父范增，发小龙且等寥寥数人；</p>
<p>《史记》中记载陈平的一句话，陈平向刘邦献计说：“项王的忠臣，只有范增、钟离眛、龙且、周殷几个人，如果你能用万金买通说客，去离间他们的君臣关系，再出兵攻打，项王必败。”刘邦遂用此计。项羽果然对忠臣疑忌，致使范增、钟离眛、周殷等忠臣纷纷离去，几乎只有龙且没有离开。”</p>
<p>由此可见，人才计划在一个国家或是企业尤为重要！</p>
<blockquote>
<p>那么，刘邦为什么能胜？这个我们放到下期来讲~ 回见！</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/04/09/分成两半的子爵/" itemprop="url">
                  《分成两半的子爵》
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-09T16:31:55+08:00" content="2016-04-09">
              2016-04-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/阅读/" itemprop="url" rel="index">
                    <span itemprop="name">阅读</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/09/分成两半的子爵/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/09/分成两半的子爵/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>卡尔维诺经典，《分成两半的子爵》一书中有这么两段话让我印象深刻：</p>
<blockquote>
<p>“如果能够将一切东西都一劈为二的话，那么人人都可以摆脱他那愚蠢的完整概念的束缚了。我原来是完整的人。那时什么东西在我看来都是自然而混乱的，像空气一样简单。我以为什么都已看清，其实只看到皮毛而已。假如你将变成你自己的一半的话，孩子，我祝愿你如此，你便会了解用整个头脑的普通智力所不能了解的东西。你虽然失去了你自己和世界的一半，但是留下的这一半将是千倍的深刻和珍贵。你也将会愿意一切东西都如你所想象的那样变成半个，因为美好、智慧、正义只存在于被破坏之后。”    </p>
</blockquote>
<hr>
<blockquote>
<p>“这就是做半个人的好处：理解世界上每个人由于自我不完整而感到的痛苦，理解每一事物由于自身不完全而形成的缺陷。我过去时完整的，那时我还不明白这些道理，我走在遍地的痛苦和伤痕之中却视而不见、充耳不闻，一个完整的人不敢相信这样的事实。”</p>
</blockquote>
<p> 《分成两半的子爵》讲述的人物不仅仅是在战场上被土耳其人用炮火炸成两半的子爵，还有造绞刑架的工匠，子爵的奶妈，英格兰大夫，他们在这场故事中的表现如现实中存在的人物一样，讲述的是一场关于道德价值的故事。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/26/HTML5缓存的那些事/" itemprop="url">
                  HTML5缓存的那些事
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-26T13:34:46+08:00" content="2016-03-26">
              2016-03-26
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/性能优化/" itemprop="url" rel="index">
                    <span itemprop="name">性能优化</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/26/HTML5缓存的那些事/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/26/HTML5缓存的那些事/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="关于存储"><a href="#关于存储" class="headerlink" title="关于存储"></a>关于存储</h2><p>说道存储，你可能会想到这是服务器端的一种设置。</p>
<p>服务器端的存储介质大体上分为4种：</p>
<ul>
<li>cache:缓存，它可以让从数据库、磁盘上输出的东西/数据放置在缓存里，从而减少数据库或是磁盘的读取与写入（IO）操作；</li>
<li>磁盘文件：如，我们常常会将图片、视频等文件存放在磁盘上；</li>
<li>数据库：mySql\mongoDB…关系\非关系数据库；</li>
<li>内存：通常放置频繁要使用到的东西，能够提高读取效率；缓存（cache）也是存放在内存里的；</li>
</ul>
<h3 id="HTML的存储-cookies"><a href="#HTML的存储-cookies" class="headerlink" title="HTML的存储-cookies"></a>HTML的存储-cookies</h3><p>在HTML5出生之前，通常在浏览器（客户端）使用cookies来存储客户端的内容；</p>
<p>cookies的特点：</p>
<ul>
<li>每次的http请求头中，都会带有cookies——缺点；</li>
<li>每个域名只能存储4K大小的cookies;</li>
<li>主域名污染：如果我们使用cookies存储主域名的东西，那么子域名下得Http请求都会带上主域名的东西；</li>
</ul>
<p>如果关联上网络，那么将带来安全问题。</p>
<blockquote>
<p>所以，通常我们会使用cookies用在如购物车、身份验证等问题上。</p>
</blockquote>
<p>下面，我们来看一下百度首页的cookies在浏览器端的一个存储形态:</p>
<p>如图：</p>
<p><img src="./img/h5_cache/cc01.png" alt="alt text"></p>
<p>HTTP这一列，如果在setCookie的时候，这里就会打钩，这与HTTPOnly相关。</p>
<p>HTTPOnly：</p>
<p>如果把HTTPOnly设置为true,那么cookies只能被server服务器端来读取或是修改，客户端没有权限进行读取和修改。例如，我们在进行身份验证的时候，就可以使用这个。</p>
<p>Secure：与安全相关，如果设置了，那么请求只能是来自HTTP加密请求。</p>
<h3 id="HTML的存储-UserData"><a href="#HTML的存储-UserData" class="headerlink" title="HTML的存储-UserData"></a>HTML的存储-UserData</h3><ul>
<li>只有IE支持，有微软提供API，但不符合W3C标准；</li>
<li>存储在XML文件中；</li>
</ul>
<h3 id="HTML5的存储"><a href="#HTML5的存储" class="headerlink" title="HTML5的存储"></a>HTML5的存储</h3><p>针对以上问题，HTML5的出现，需要解决以下问题:</p>
<ul>
<li>解决4K的大小问题；</li>
<li>解决请求头常带存储信息的问题；</li>
<li>解决关系型存储的问题；</li>
<li>跨浏览器平台问题；</li>
</ul>
<p>##HTML5存储形式</p>
<ul>
<li>本地存储——localstorage \sessionstorage</li>
<li>离线缓存——application cache</li>
<li>IndexedDB、Web SQL</li>
</ul>
<h3 id="本地存储"><a href="#本地存储" class="headerlink" title="本地存储"></a>本地存储</h3><p>API：</p>
<p>localstorage 、sessionstorage</p>
<p>存储形式：</p>
<p>key–&gt;value</p>
<p>过期时间：</p>
<p>localstorage:永久存储，永不失效，除非手动删除<br>sessionstorage:重新打开页面，或是关闭浏览器，sessionstorage才会消失；</p>
<p>存储大小：<br>每个域名能存5M；</p>
<p>支持情况：</p>
<p>IE8+,safari3.2+,chrome,firefox等主流浏览器都支持；</p>
<p>使用方法——localstorage\sessionstorage</p>
<p>主要涉及到5个方法：</p>
<ul>
<li>getItem:获取localstorage\sessionstorage</li>
<li>setItem:设置localstorage\sessionstorage</li>
<li>removeItem:移除localstorage\sessionstorage</li>
<li>key:获取某一个位置上的key值,按值从0开始索引；</li>
<li>clear:全部清除localstorage\sessionstorage</li>
</ul>
<p>例如：我们打开www.baidu.com</p>
<p>在控制台Console输出面板，输入：</p>
<p><code>localStorage.setItem(&quot;test1&quot;,&quot;test&quot;);</code><br>那么在Resources面板的Local Storage下，将出现Key=test1,value=test的记录</p>
<p><code>localStorage.getItem(&quot;test1&quot;);</code> //输出test</p>
<p><code>localStorage.key(0);</code>//输出BDSUGSTORED</p>
<p>sessionstorage的API与localstorage一样，但是你要注意一点：</p>
<p><strong>sessionStorage需要在浏览器关闭或是重新打开页面，才会消失；</strong></p>
<h3 id="本地存储可以存储什么？"><a href="#本地存储可以存储什么？" class="headerlink" title="本地存储可以存储什么？"></a>本地存储可以存储什么？</h3><ul>
<li>数组（需要将其序列化为字符串才能存储）；</li>
<li>json数据——将其转化为字符串存储；</li>
<li>图片</li>
<li>脚本、样式文件：通过ajax</li>
</ul>
<p>只要能被转化为字符串的数据，都能被localstorage存储；</p>
<h3 id="本地存储如何存储图片"><a href="#本地存储如何存储图片" class="headerlink" title="本地存储如何存储图片"></a>本地存储如何存储图片</h3><p>先来看一段代码：</p>
<pre><code>var src=&quot;demo.jpg&quot;;

function set(key){
    var img=document.createElement(&apos;img&apos;);

    img.addEventListener(&quot;load&quot;,function(){
        //创建一个canvas
        var imgCanvas=document.createElement(&quot;canvas&quot;),
        imgContext=imgCanvas.getContext(&quot;2d&quot;);
        //确保canvas元素的大小和图片的尺寸一致
        imgCanvas.width=this.width;
        imgCanvas.height=this.height;
        //渲染图片到canvas中,使用canvas的drawImage()方法
        imgContext.drawImage(this,0,0,this.width,this.height);
        //用canvas的dataUrl的形式取出图片,imgAsDataURL是一个base64的字符串
        var imgAsDataURL=imgCanvas.toDataURL(&quot;image/png&quot;);
        //保存到本地存储中
        //使用try-catch()查看是否支持localstorage
        try{
            localStorage.setItem(key,imgAsDataURL);//将取出的图片存放到localStorage 
        }
        catch(e) {
         console.log(&quot;Storage failed:&quot;+e);//存储失败
        }

    },false);
    img.src=src;
}    
function get(key) {//从本地缓存获取图片并且渲染
var srcStr=localStorage.getItem(key);//从localStorage中取出图片
var imgObj=document.createElement(&apos;img&apos;);//创建一个img标签
imgObj.src=srcStr;
document.body.appendChild(imgObj);
}

    注释：
    (1)、这个比较适合用在不常更改的图片，但是如果图片的base64大小比较大的话，将比较耗费localStorage的资源；

    (2)、canvas有一个安全策略的问题：如果图片和你本身请求的域名不在同一个域名下，浏览器会报出一个安全问题，这个时候我们要给我们的服务器加一个“允许跨域”访问的响应头————Access Orign=*,这样来保证你的图片可进行跨域被canvas来画；
</code></pre><h3 id="HTML5本地存储需要注意的："><a href="#HTML5本地存储需要注意的：" class="headerlink" title="HTML5本地存储需要注意的："></a>HTML5本地存储需要注意的：</h3><ul>
<li>使用前判断浏览器是否支持localStorage；（IOS浏览器在无痕模式浏览下，是无法打开localStorage；以及，其他奇葩浏览器，在存储localstorage的时候报错）</li>
</ul>
<p>做法：根据前面代码，我们在检查是否支持，先进行setItem()一次，然后对setItem进行异常捕获；</p>
<ul>
<li><p>写数据的时候，需要异常处理，避免超出容量抛出错误；<br>localStorage本身只有5M；</p>
</li>
<li><p>避免把敏感的信息存入localStorage；</p>
</li>
<li><p>key的唯一性；重复写，将会覆盖之前的key;</p>
</li>
</ul>
<h3 id="HTML5本地存储使用限制："><a href="#HTML5本地存储使用限制：" class="headerlink" title="HTML5本地存储使用限制："></a>HTML5本地存储使用限制：</h3><ul>
<li>存储更新策略，过期控制：localStorage是永不过期的，业务上如果想实现一些过期策略，需要在localStorage上加一层处理过期的机制；</li>
<li>各个子域名之间不能共享存储数据；（借助H5的postMessage()这个API做一些跨域上得处理）</li>
<li>超出存储大小之后如何存储——使用一些如LRU、FIFO的算法去淘汰一些旧的数据；</li>
<li>server端如何取到数据——使用post/get参数</li>
</ul>
<h3 id="处理过期控制"><a href="#处理过期控制" class="headerlink" title="处理过期控制"></a>处理过期控制</h3><p>先来看一下代码：</p>
<pre><code>function set(key,y){
    var curTime=new Date().getTime();
    //存储一个当时存储时候的时间
    localStorage.setItem(key,JSON.stringify({data:v,time:curTime}));

}
function get(key,exp) {
    var data=localStorage.getItem(key);
    var dataObj=JSON.parse(data);
    if(new Date().getTime()-dataObj.time&gt;exp) {//get出来的时间减去当时存储的时间大于过期时间，那么就认为过期
       console.log(&quot;过期&quot;);
    }else {
    //否则，返回值
     console.log(&quot;data=&quot;+dataObj.data);
    }
}
</code></pre><h3 id="本地存储使用场景"><a href="#本地存储使用场景" class="headerlink" title="本地存储使用场景"></a>本地存储使用场景</h3><ul>
<li>本地数据存储，减少网络传输</li>
<li>在弱网络的环境下，会发生高延迟，低带宽，应该尽量把数据（如脚本、样式）本地化；</li>
</ul>
<p>我们来看一张图，显示的是本地存储和网络拉取耗时的对比：</p>
<p><img src="./img/h5_cache/cc03.png" alt="alt text"></p>
<h2 id="IndexedDB"><a href="#IndexedDB" class="headerlink" title="IndexedDB"></a>IndexedDB</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>IndexedDB,是一种能做浏览器中持久地存储结构化数据的数据库，并且为web应用提供了丰富的查询能力；</p>
<h3 id="支持情况"><a href="#支持情况" class="headerlink" title="支持情况"></a>支持情况</h3><p>chrome11+\opera不支持\firefox 4+\IE 10+,移动端浏览器支持能力弱</p>
<h3 id="存储结构"><a href="#存储结构" class="headerlink" title="存储结构"></a>存储结构</h3><p>IndexedDB是按域名分配独立空间，一个独立域名下可以创建多个数据库，每个数据库可以创建对个对象存储空间（表/table）,一个对象存储空间可以存储多个对象数据；</p>
<p>如图：</p>
<p><img src="./img/h5_cache/cc04.png" alt="alt text"></p>
<h3 id="使用IndexedDB实现离线数据库"><a href="#使用IndexedDB实现离线数据库" class="headerlink" title="使用IndexedDB实现离线数据库"></a>使用IndexedDB实现离线数据库</h3><p>这里我们主要从IndexedDB 的四大功能入手：</p>
<ul>
<li>增删改</li>
<li>事务处理</li>
<li>游标</li>
<li>索引</li>
</ul>
<p>下面我们通过一段代码来讲解，请关注里面的注释：</p>
<pre><code> &lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;name&quot;&gt;姓名：&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;name&quot; value=&quot;&quot; /&gt;    
    &lt;label for=&quot;phone&quot;&gt;电话：&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;phone&quot; value=&quot;&quot; /&gt;    
    &lt;label for=&quot;address&quot;&gt;地址:&lt;/label&gt;&lt;input type=&quot;text&quot; id=&quot;address&quot; value=&quot;&quot; /&gt;    
    &lt;input type=&quot;button&quot; id=&quot;seletBtn&quot; value=&quot;查询&quot; /&gt;    
    &lt;input type=&quot;button&quot; id=&quot;add&quot; value=&quot;添加&quot; /&gt;    
    &lt;input type=&quot;button&quot; id=&quot;deleteDB&quot; value=&quot;删除数据库&quot; /&gt;    
&lt;/div&gt;


&lt;script type=&quot;text/javascript&quot;&gt;
    var db;
    var arrayKey=[];
    var openRequest;
    var lastCursor;
    var indexedDB=window.indexedDB || window.webkitIndexedDB || window.mozIndexedDB || window.msIndexedDB;//indexedDB在不同的浏览器下不同

    var dbName=&quot;person&quot;;//数据库名称
    var tableName=&quot;testTable&quot;;//表名称
    function init() {
        openRequest=indexedDB.open(dbName);//页面加载时先打开一个DB，如果该DB存在，则打开；不存在，则新建

        //触发事件——当一个“新的数据库”被创建或者数据库的“版本号”被更改时触发
        openRequest.onupgradeneeded=function(e){
            console.log(&quot;onupgradeneeded&quot;);
            var thisDb=e.target.result;
            console.log(thisDb.version);

            //检查这个数据库中是否包含我们要查找的表
            if(!thisDb.objectStoreNames.contains(tableName)){
                //不包含——创建一个表
                console.log(&quot;需要创建一个objectStore&quot;);
                //keyPath:主键，autoIncrement：主键自增
                var objectStore=thisDb.createObjectStore(tableName,{keyPath:&quot;id&quot;,autoIncrement:true});
                //创建表的时候，指定哪些字段是能被索引的
                objectStore.createIndex(&quot;name&quot;,&quot;name&quot;,{unique:false});//创建索引
                objectStore.createIndex(&quot;phone&quot;,&quot;phone&quot;,{unique:false});
            }

        }
        //触发事件——成功打开一个数据库时触发
        openRequest.onsuccess=function(e){
            db=e.target.result;
            console.log(db.version);
            db.onerror=function(event){
                alert(&quot;数据库错误:&quot;+event.target.errorCode);
                console.dir(event.target);
            };
            //判断该数据库中有没有这个表
            if(db.objectStoreNames.contains(tableName)){
                //存在这个表
                console.log(&quot;包含表：&quot;+tableName);
                //通过事物机制操作一个表的读写，从而保证数据的一致性和可靠性
                var transaction=db.transaction([tableName],&quot;readwrite&quot;);
                //事物的事件
                transaction.oncomplete=function(event){
                    console.log(&quot;完成&quot;);
                };

                transaction.onerror=function(event){
                    console.dir(event);
                };
                var objectStore=transaction.objectStore(tableName);//通过事物获取表中一个objectStore对象,即表的对象

                //遍历表的记录——游标-openCursor,这是indexedDb的重点
                objectStore.openCursor().onsuccess=function(event){
                    var cursor=event.target.result;
                    if(cursor){
                        console.log(cursor.key);
                        console.dir(cursor.value);
                        render({key:cursor.key,name:cursor.value[&quot;name&quot;],phone:cursor.value[&quot;phone&quot;],address:cursor.value[&quot;address&quot;]});
                        lastCursor=cursor.key;//如果不设置lastCursor,那么游标默认是下一条接着下一条来遍历；设置了lastCursor,游标将循环遍历
                        cursor.continue();
                    }else {
                        console.log(&quot;请使用游标来搞定&quot;);
                    }
                };
                objectStore.openCursor().onerror=function(event){
                    console.dir(event);
                };

            }

        }


        //添加新记录
        document.querySelector(&quot;#add&quot;).addEventListener(&quot;click&quot;,function(){
            var name=document.querySelector(&quot;#name&quot;).value();
            var phone=document.querySelector(&quot;#phone&quot;).value();
            var address=document.querySelector(&quot;address&quot;).value();
            var person={&quot;name&quot;:name,&quot;phone&quot;:phone,&quot;address&quot;:address};//设置对象
            //通过事务——操作表
            var transaction=db.transaction([tableName],&quot;readwrite&quot;);
            transaction.oncomplete=function(event){
                console.log(&quot;事务处理完成&quot;);
            };
            transaction.onerror=function(event){
                console.dir(event);
            };
            var objectStore=transaction.objectStore(tableName);//创建一个表对象
            objectStore.add(person);//添加对象到表中——add()
            //将新增的记录显示处理
            objectStore.openCursor().onsuccess=function(event){
                cursor=event.target.result;
                var key;
                if(lastCursor==null){
                    key=cursor.key;
                    lastCursor=key;
                }else {
                    key=++lastCursor;
                }
                render({key:key,name:name,phone:phone,address:address});
                console.log(&quot;成功添加新记录:&quot;+key);
                console.dir(person);
            }

        });

        //删除指定ID
        function deleteRecord(id){
            var transaction=db.transaction([tableName],&quot;readwrite&quot;);
            transaction.oncomplete=function(event){
                console.log(&quot;事务处理完成&quot;);
            };
            transaction.onerror=function(event){
                console.dir(event);
            };
            var objectStore=transaction.objectStore(tableName);
            var removeKey=parseInt(id);
            var getRequest=objectStore.get(removeKey);//获取索引值---get()
            getRequest.onsuccess=function(e){
                var result=getRequest.result;
                console.dir(result);
            }
            var request=objectStore.delete(removeKey);//删除——delete
            request.onsuccess=function(e){
                console.log(&quot;删除成功&quot;);
            };
            request.onerror=function(e){
                console.log(&quot;删除错误&quot;+e);
            };
            //隐藏删除的DOM
            document.getElementById(removeKey).style.display=&quot;none&quot;;
        }

        //查询记录
        document.querySelector(&quot;#seletBtn&quot;).addEventListener(&quot;click&quot;,function(){
            var curName=document.getElementById(&quot;selname&quot;).value；
            var transaction=db.transaction([tableName],&quot;readwrite&quot;);
            transaction.oncomplete=function(event){
                console.log(&quot;事务处理完成&quot;);
            };
            transaction.onerror=function(event){
                console.dir(event);
            };
            var objectStore=transaction.objectStore(tableName);
            var boundKeyRange=IDBKeyRange.only(curName);//生成一个表示范围的Range对象---IDBKeyRange,有4个方法，only\lowerBound\upperBound\bound
            objectStore.index(&quot;name&quot;).openCursor(boundKeyRange).onsuccess=function(event){
                //从indexedDb中找到name
                var cursor=event.target.result;
                if(!cursor){
                    return;
                }
                var rowData=cursor.value;
                console.log(rowData);
                document.getElementById(&apos;content&apos;).innerHTML=&quot;&quot;;
                render({key:cursor.value.id,name:cursor.value[&quot;name&quot;],phone:cursor.value[&quot;phone&quot;],address:cursor.value[&quot;address&quot;]});
                cursor.continue();
            };

        });
        //删除数据库
        document.querySelector(&quot;#deleteDB&quot;).addEventListener(&quot;click&quot;,function(){
            //使用deleteDatabase()
            var deleteDB=indexedDB.deleteDatabase(dbName);
            var content=document.querySelector(&quot;#content&quot;);
            while(content.firstChild){
                content.removeChild(content.firstChild);
            }
            deleteDB.onsuccess=function(event){
                console.log(&quot;删除成功&quot;);
            };
            deleteDB.onerror=function(event){
                console.dir(event.target);
            };
        });

        //渲染
        function render(opt){
            var child_node = document.createElement(&quot;div&quot;);
            var child_node_child1 = document.createElement(&quot;div&quot;);
            var child_node_child2 = document.createElement(&quot;div&quot;);
            var child_node_child3 = document.createElement(&quot;div&quot;);
            var child_node_child4 = document.createElement(&quot;div&quot;);
            child_node_child1.setAttribute(&quot;class&quot;,&quot;table_child&quot;);
            child_node_child2.setAttribute(&quot;class&quot;,&quot;table_child&quot;);
            child_node_child3.setAttribute(&quot;class&quot;,&quot;table_child&quot;);
            child_node_child4.setAttribute(&quot;class&quot;,&quot;table_child&quot;);
            child_node_child1.setAttribute(&quot;style&quot;,&quot;float:left&quot;);
            child_node_child2.setAttribute(&quot;style&quot;,&quot;float:left&quot;);
            child_node_child3.setAttribute(&quot;style&quot;,&quot;float:left&quot;);
            child_node_child4.setAttribute(&quot;style&quot;,&quot;float:left&quot;);
            child_node_child1.innerHTML = name;
            child_node_child2.innerHTML = opt.phone;
            child_node_child3.innerHTML = opt.address;
            child_node_child4.innerHTML = &quot;&lt;input type=&apos;button&apos; value=&apos;删除&apos;&gt;&quot;
            child_node.appendChild(child_node_child1);
            child_node.appendChild(child_node_child2);
            child_node.appendChild(child_node_child3);
            child_node.appendChild(child_node_child4);
            child_node.setAttribute(&quot;class&quot;,&quot;table_tr&quot;);
            child_node.setAttribute(&quot;id&quot;,opt.key);
            var content = document.getElementById(&apos;content&apos;);
            content.appendChild(child_node)

        }

    }
&lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre><h2 id="离线缓存——application-Cache"><a href="#离线缓存——application-Cache" class="headerlink" title="离线缓存——application Cache"></a>离线缓存——application Cache</h2><h3 id="何为离线缓存"><a href="#何为离线缓存" class="headerlink" title="何为离线缓存"></a>何为离线缓存</h3><blockquote>
<p>它是能让web应用在离线的情况下继续使用，通过一个叫manifest的文件指明需要缓存的资源；你可以通过<code>navigator.online</code>检测是否在线；</p>
</blockquote>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>如图：</p>
<p><img src="./img/h5_cache/cc05.png" alt="alt text"></p>
<p>解释：</p>
<p>（1）用户通过浏览器（browser）去访问应用，首先检测浏览器是否有一个叫做“App cache”的东西存在，如果存在，则从中检索出app cache所要缓存的list,然后把资源（缓存在浏览器中）拉取出来，返回给用户；</p>
<p>（2）在访问的同时，会检查server上一个叫做manifest的文件，如果该文件有更新，就把manifest指定的文件从server端重新拉取一次，然后把这些缓存在浏览器中，并更新相应的app cache文件；如果manifest这个文件没有更新，那么就啥也不做。</p>
<p>从上图，我们总结2点：</p>
<ul>
<li>缓存机制的改变，会更新app cache.但是，用户访问，会返回上一次的结果。这样一来，会有一个麻烦，即如果你的业务发生更改，你就需要去更新一次manifest。</li>
</ul>
<p>注意：更改完，第一次是不生效的，只有第二次刷新才会生效；</p>
<ul>
<li>如果有一个文件要更新，你就要去更新manifest,而更新manifest文件，它会把server上的文件全部重新拉取一次，而非只是拉取你需要更改的那个文件，这就会造成损耗；</li>
</ul>
<h3 id="浏览器支持情况"><a href="#浏览器支持情况" class="headerlink" title="浏览器支持情况"></a>浏览器支持情况</h3><p>safari on ios 3.2+\android 1,5+\window phone 9+</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>例子：cache.appcache</p>
<pre><code>CACHE MANIFEST

#version 1.0

CACHE:

#需要缓存的文件
/css/a.css
/js/a/js
/images/a.png

NETWORK:

#每次重新拉取的文件

*

FALLBACK

#离线状况下代替的文件

/404.html
</code></pre><p>在页面上引入manifest文件:</p>
<p><code>&lt;html manifest=&quot;cache.appcache&quot;&gt;</code></p>
<p>在服务器添加<code>mime-type text/cache-manifest</code></p>
<p>如果在服务器上添加：</p>
<p>找到你的xampp/apache/conf目录,找到mime.types文件，在最后面添加一条记录：</p>
<p><code>text/cache-manifest  appcache</code>   （appcache是后缀名，你可以选择其他的）</p>
<p>我们来看一个例子：</p>
<pre><code>&lt;html lang=&quot;en&quot; manifest=&quot;cache.appcache&quot;&gt;
  &lt;head&gt;
    &lt;meat charset=&quot;utf-8&quot; /&gt;
  &lt;/head&gt;
  &lt;body&gt;
     &lt;h1&gt;&lt;demo1/h1&gt;

  &lt;script type=&quot;text/javascript&quot;&gt;
    window.addEventListener(&apos;load&apos;,function(e){
    //监听app cache的updateready事件
     window.applicationCache.addEventListener(&apos;updateready&apos;,function(e)){

        console.log(window.applicationCache.status);
        if(window.applicatioinCache.status==window.applicationCache.UPDATEREADY){
        //application cache的版本号发生改年
          window.applicationCache.swapCache();
          window.location.reload();
        }else {
          console.log(&quot;manifest没有更改&quot;);
        }
    },false);
  },false);
  &lt;/script&gt;
  &lt;/body&gt;

&lt;/html&gt;
</code></pre><p>注意：</p>
<ul>
<li><p>app cache会自动地将本页当做一个静态页缓存；</p>
</li>
<li><p>如果你要更新，请更新server端的manifest文件的版本；</p>
</li>
<li><p>如果你不想启用app cache,或者说现在app cache不适合你现在的应用，那么有一个做法：</p>
</li>
</ul>
<p>更改server端上manifest文件的名称，例如<code>cache1.appcache</code>,这个时候再去刷新浏览器，首先，浏览器还是会从app cache缓存中读取缓存，到第二次刷新的时候，浏览器会到server端查找manifest文件，发现这个文件不存在，那么浏览器会走网络从Server上重新拉取文件；</p>
<h3 id="app-cache优势："><a href="#app-cache优势：" class="headerlink" title="app cache优势："></a>app cache优势：</h3><ul>
<li>完全离线</li>
<li>资源缓存，加载更快</li>
<li>降低服务器负载</li>
</ul>
<h3 id="app-cache缺陷："><a href="#app-cache缺陷：" class="headerlink" title="app cache缺陷："></a>app cache缺陷：</h3><ul>
<li>含有manifest属性的当前请求页无论如何都会被缓存；</li>
<li>更新需要建立在manifest文件的更新，文件更新后是需要页面再次刷新的，并且在第2次刷新才能获取新资源；</li>
<li>更新是全局性的，无法单独更新某个文件；</li>
<li>对于链接的参数变化的敏感的，任何一个参数的修改都会被重新缓存，例如：index.html和index.html?v=1会被认为是不同文件，分别缓存；</li>
</ul>
<h3 id="app-cache适用场景"><a href="#app-cache适用场景" class="headerlink" title="app cache适用场景"></a>app cache适用场景</h3><ul>
<li>单地址页面</li>
<li>对实时性要求不要的业务</li>
<li>离线web应用</li>
</ul>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在实际应用中，我们需要根据业务的需要来采取相应的缓存措施，如上所述，html5的几种缓存都有各自的优缺点和适用场景，有时我们也需要组合使用。</p>
<p>关于HTML5缓存我们就介绍到这里。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://rainsilence.iteye.com/blog/984569" target="_blank" rel="external">HTML5之IndexedDB使用详解</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/20/【01】前端开发环境配置/" itemprop="url">
                  fis-plus【01】——前端开发环境配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-20T10:43:48+08:00" content="2016-03-20">
              2016-03-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/自动化工具/" itemprop="url" rel="index">
                    <span itemprop="name">自动化工具</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/20/【01】前端开发环境配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/20/【01】前端开发环境配置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="fis-plus【01】——前端开发环境配置"><a href="#fis-plus【01】——前端开发环境配置" class="headerlink" title="fis-plus【01】——前端开发环境配置"></a>fis-plus【01】——前端开发环境配置</h1><p>前端自动化工具确实给前端同学带来的极大的方便，这一篇中我们将通过介绍fis-plus来配置前端的开发环境。</p>
<p>av8d,请坐好哦~</p>
<p><img src="./img/gaoxiao01.jpeg" alt="alt text"></p>
<h2 id="一、fis-plus引入"><a href="#一、fis-plus引入" class="headerlink" title="一、fis-plus引入"></a>一、fis-plus引入</h2><blockquote>
<p>fis-plus能够把前端当做整个PHP的开发环境来渲染，包括它能对smarty的开发环境能够很好的支持。<br>官网网站：<br><a href="http://fex-team.github.io/fis-plus/" target="_blank" rel="external">fis-plus</a></p>
</blockquote>
<p>首先我们进行安装</p>
<p>在命令行输入：<code>npm install -g fis-plus</code></p>
<p>如果你在安装过程中遇到网络问题，安装不成功，你可以通过淘宝镜像进行安装。<br>淘宝镜像安装教程参照：<br>[<a href="http://npm.taobao.org/" target="_blank" rel="external">http://npm.taobao.org/</a>]</p>
<p>安装完cnpm，之后执行 <code>cnpm install -g fis-plus</code></p>
<p>查看是否安装成功：<br>在命令行输入： <code>fisp -v</code></p>
<p>如有下图所示，则表示成功：</p>
<p><img src="./img/fisp01.png" alt="alt text"></p>
<blockquote>
<p>在fisp的官网首页，我们看到fisp提供能很完善的解决方案，这个比gulp或是grunt都要来的出色。在平时，如果要写这些PHP smaty的解决方案，是需要花费很大成本的，现在通过fisp来节约我们的开发和优化时间。</p>
</blockquote>
<p><strong>注释:</strong> smarty是一个使用PHP写出来的模板PHP模板引擎，它提供了逻辑与外在内容的分离，简单的讲，目的就是要使用PHP程序员同美工分离,使用的程序员改变程序的逻辑内容不会影响到美工的页面设计，美工重新修改页面不会影响到程序的程序逻辑，这在多人合作的项目中显的尤为重要。</p>
<p><img src="./img/fisp02.png" alt="alt text"></p>
<h2 id="二、fis-plus是做什么的？"><a href="#二、fis-plus是做什么的？" class="headerlink" title="二、fis-plus是做什么的？"></a>二、fis-plus是做什么的？</h2><p><img src="./img/gaoxiao02.jpeg" alt="alt text"></p>
<blockquote>
<p>FIS-PLUS 是基于 FIS，应用于后端是 PHP，模板是 Smarty 的场景,是扩展自FIS的前端集成解决方案。其提供 后端框架、前端框架、自动化工具、辅助开发工具等开发套件。</p>
</blockquote>
<p>在安装fis-plus之前，fis-plus对环境有要求：</p>
<ul>
<li>（1）安装node ,&gt;=0.8.0的版本；</li>
<li>（2）jre版本，&gt;=1.5.0,用于本地调式</li>
<li>（3）php-cgi版本，&gt;=5.0.0，用于本地调式</li>
</ul>
<p>说一下php-cgi的安装，这里我们通过Brew来安装，<br>首先你需要安装brew,官网：<a href="http://brew.sh/index_zh-cn.html" target="_blank" rel="external">homebrew</a>。</p>
<p>在命令行输入：</p>
<p><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code>进行安装。</p>
<p>安装成功之后，在命令行输入：<code>brew install php55 --with-cgi</code>安装php-cgi。</p>
<p>上面的三个环境都安装完成之后，我们在命令行输入：</p>
<p><code>fisp server start</code>你就能看到如下结果，这时会启动fisp 的调式服务器。</p>
<p><img src="./img/fisp03.png" alt="alt text"></p>
<p>浏览器也会打开：</p>
<p><img src="./img/fisp04.png" alt="alt text"></p>
<p>在上图，你可以看到这个目录的路径。</p>
<p>现在我们进入到这个文件夹中 <code>cd /Users/imaginexie/.fis-plus-tmp/www</code></p>
<p>然后看一下这个目录下有什么文件：<code>dir</code>，然后打开这个目录<code>open .</code></p>
<p><img src="./img/fisp05.png" alt="alt text"></p>
<p>当然啦~这个目录只是本地server目录，但是其实，当我们在线上开发的时候，我们有一个真正的server。</p>
<p>fis-plus支持把线下（本地）的资源直接放到线上。</p>
<h3 id="2-1、lights"><a href="#2-1、lights" class="headerlink" title="2.1、lights"></a>2.1、lights</h3><p>说道这里，你是不是睡着了？？？让你睡~</p>
<p><img src="./img/gaoxiao03.jpeg" alt="alt text"></p>
<p>lights 是 fis 提供的包管理工具，托管了 fis 所有资源。是使用 fis 的时候，必不可少的利器。</p>
<p>首先我们安装lights:<code>npm install -g lights</code></p>
<p>然后下载一个PC端案例：我们在桌面上安装 <code>lights install pc-demo</code></p>
<p>安装成功之后，你的桌面上会出现一个pc-demo的文件夹。</p>
<p>OK，现在我们来打开这个pc-demo目录，看看它都包含了哪些东西。</p>
<p><img src="./img/fisp06.png" alt="alt text"></p>
<blockquote>
<p>在这个文件夹中，我们看到，common和home目录下都有一个fis-conf.js配置文件。</p>
<p>在common（common文件夹是所有静态资源的结合）的fis-conf.js中我们看到：</p>
<p>配置文件对css和js进行了打包（pack），打包到了static/pkg这个目录下。<br>home目录下也是同理。</p>
</blockquote>
<p>然后我们再看看home目录下，page/index.tpl这个模板文件：</p>
<p><img src="./img/fisp07.png" alt="alt text"></p>
<p>我们看到这里面使用了require对静态资源进行加载。这个require模块加载主要用到的是fis自己写的mod.js，它也是一个类似于require.js或sea.js的模块化脚本。mod.js属于cmd规范。这个源码理解起来不然，你可以看下，因为mod.js主要是用来加载资源的。</p>
<p>然后我们再来看下common/page/layout.tpl</p>
<p><img src="./img/fisp08.png" alt="alt text"></p>
<p>page其实主要是用来组装widge文件下的widget组件。只是对页面进行渲染，而不负责输出。</p>
<p>再来看下package.json这个文件：</p>
<p><img src="./img/fisp09.png" alt="alt text"></p>
<p>这些文件在编译的时候会编译成smaty对应的文件夹，以及一个静态的文件夹。</p>
<p>现在我们来发布这个PC-demo。</p>
<p>在pc-demo目录下，命令行分别输入<code>fisp release -r common</code></p>
<p><code>fisp release -r home</code>，即，对common和home这两个目录进行发布（release）。</p>
<p>发布完成之后，命令行输入：<code>fisp server start</code>来启动服务器。</p>
<p>这个时候我们在浏览器上看到的还是这个：</p>
<p><img src="./img/fisp10.png" alt="alt text"></p>
<p><strong>你可能会疑惑，怎么啥变化没有呀？？？</strong></p>
<p>hold住~我们进入到pc-demo 的www目录下查看下发生了什么：</p>
<p><code>cd /Users/imaginexie/.fis-plus-tmp/www</code></p>
<p>我们看到如下：</p>
<p><img src="./img/fisp11.png" alt="alt text"></p>
<p><img src="./img/fisp12.png" alt="alt text"></p>
<p>这些文件把我们前端的东西都打包了过来。对比之前我们在进行<code>fisp server start</code>的时候，是不是发生了很大的变化。</p>
<p>这里生成了一个static文件夹，对应生成了common和home目录。如图：</p>
<p><img src="./img/fisp13.png" alt="alt text"></p>
<p>啊哈~马上要大功告成啦~感动啊</p>
<p><img src="./img/gaoxiao04.jpeg" alt="alt text"></p>
<blockquote>
<p>现在，我们把www这个文件夹拽到sublime中。然后对默认的首页index.php进行重命名：index_w.php。即&gt; 把默认的首页去除。</p>
<p>然后，我们在命令行输入<code>cd ..</code>先退出www目录，返回到上级，然后执行<code>fisp server init</code>初始化模拟线上环境。</p>
</blockquote>
<p>我们再到浏览器来刷新一下 127.0.0.1:8080。这个时候你会看到：</p>
<p><img src="./img/fisp14.png" alt="alt text"></p>
<p>这就是fis给我提供的pc-demo的网站。</p>
<p>下面我们来了解下fis-plus发布（release）的时候用到的命令。<br>输入<code>fisp release -h</code>可以看到fis-plus release为我们提供了如下：</p>
<p><img src="./img/fisp15.png" alt="alt text"></p>
<p>其中，都做了详细的解释。你可以按着上面的命令选项进行尝试，同时这些命令可以同时组合使用，例如<code>fisp release -Domupld</code>。</p>
<blockquote>
<p>Ok ,以上是关于fis-plus在前端开发中得环境配置，但是我们还需要配置后端的开发环境，下一节我们将深入&gt; 讲解fis-plus和后端的环境配置。</p>
</blockquote>
<p><img src="./img/gaoxiao05.jpeg" alt="alt text"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/19/start/" itemprop="url">
                  start 2016.03.19
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-03-19T21:01:47+08:00" content="2016-03-19">
              2016-03-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/随笔/" itemprop="url" rel="index">
                    <span itemprop="name">随笔</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/03/19/start/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/03/19/start/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从今天起，慢慢将blog从CSDN、豆瓣迁移到这里，在CSDN、豆瓣上的blog会陆续更新这里的blog,以后就在这里静心记录我的生活、工作、学习。</p>
<p>还是那句话，脚踏实地，技术很纯粹，生活很简单。我们一起加油！</p>
<p>welcome to imagine-life, nice to meet you.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar2.png"
               alt="imagineXie" />
          <p class="site-author-name" itemprop="name">imagineXie</p>
          <p class="site-description motion-element" itemprop="description">this is imagine life</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">7</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/lvtraveler" target="_blank">
                  
                    <i class="fa fa-globe"></i> github
                  
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://blog.csdn.net/imaginecode" target="_blank">
                  
                    <i class="fa fa-coffee"></i> csdn
                  
                </a>
              </span>
            
          
        </div>

        
        

        
        <div class="links-of-blogroll motion-element">
          
            <div class="links-of-blogroll-title">Links</div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.babybus.com/plus/" target="_blank">bbplus</a>
                </li>
              
            </ul>
          
        </div>

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">imagineXie</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  


  




<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>

  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=0.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=0.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=0.5.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=0.5.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"imagineXie"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
  





  
  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  


</body>
</html>
